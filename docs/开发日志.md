## 2025.04.16

确定了基本的微服务架构，包含8个微服务

#### 费用查询服务

- 按就诊编号和患者编号查询
- 查看诊断详情
- 查看治疗详情
- 分页功能

## 2025.04.19

架构上将网关服务和用户认证服务合并，变为7个微服务

#### 费用查询服务

- 增加定点医疗机构字段
- 增加按医疗类别查询

> 问题："Connection leak detection triggered"和"Statement cancelled due to timeout"，连接泄漏与查询超时
>
> 解决：在MySQL为结算信息表手动创建索引，在JPA实体中保持索引定义维护代码与数据库结构的一致性

> 问题：前端未接受到医疗机构字段信息
>
> 解决：使用Lombok为实体类自动生成getter方法 

## 2025.04.20

#### 费用查询服务

- 使用Redis缓存提升查询效率

> 问题：Page对象在Redis缓存中无法正确序列化/反序列化
>
> 尝试：不直接缓存Page对象，而是分别缓存其组成部分List\<Settlement\>,再在服务层重新组装成Page对象 —>
>
> ​			方法内部调用（通过this）带@Cacheable注解的其他方法时，Spring AOP无法拦截这些调用
>
> 解决：使用AopContext.currentProxy()获取代理对象（通过proxy）来调用缓存方法

## 2025.04.21