# 微服务数据库设计文档

## 数据库概述

本数据库设计用于支持医保系统的微服务架构。每个微服务都有独立的数据库，以确保数据的隔离性和安全性。以下是针对每个微服务的数据库设计，包括用户认证服务、数据采集服务、费用查询服务、规则引擎服务、深度分析服务、可视化服务和公共服务。

## 1. 用户认证服务数据库设计

### 用户表 (users)

| 字段名        | 数据类型     | 描述         | 约束                                  |
| ------------- | ------------ | ------------ | ------------------------------------- |
| user_id       | INT          | 用户唯一标识 | 主键，自增                            |
| username      | VARCHAR(50)  | 用户名       | 唯一，不可为空                        |
| password_hash | VARCHAR(255) | 密码哈希     | 不可为空                              |
| role          | ENUM         | 用户角色     | 可选值：'admin', 'hospital', 'doctor' |
| created_at    | DATETIME     | 创建时间     | 默认当前时间                          |
| updated_at    | DATETIME     | 更新时间     | 默认当前时间                          |

## 2. 数据采集服务数据库设计

## 费用明细表 (fee_list_d2409)

## 就诊信息表 (mdtrt_d2409)

## 结算信息表 (setl_d2409)

## 结算诊断信息表 (setl_diag_list_d2409)

## 3. 费用查询服务数据库设计

## 4. 规则引擎服务数据库设计

### 规则表 (rules)

| 字段名          | 数据类型     | 描述         | 约束         |
| --------------- | ------------ | ------------ | ------------ |
| rule_id         | INT          | 规则唯一标识 | 主键，自增   |
| rule_name       | VARCHAR(100) | 规则名称     | 不可为空     |
| rule_expression | TEXT         | 规则表达式   | 不可为空     |
| created_at      | DATETIME     | 创建时间     | 默认当前时间 |
| updated_at      | DATETIME     | 更新时间     | 默认当前时间 |

## 5. 深度分析服务数据库设计

### 分析结果表 (analysis_results)

| 字段名           | 数据类型 | 描述             | 约束                            |
| ---------------- | -------- | ---------------- | ------------------------------- |
| result_id        | INT      | 分析结果唯一标识 | 主键，自增                      |
| hospital_id      | INT      | 医院唯一标识     | 外键，关联医院表                |
| analysis_date    | DATETIME | 分析日期         | 不可为空                        |
| risk_level       | ENUM     | 风险等级         | 可选值：'low', 'medium', 'high' |
| analysis_details | TEXT     | 分析详细信息     | 可选                            |
| created_at       | DATETIME | 创建时间         | 默认当前时间                    |
| updated_at       | DATETIME | 更新时间         | 默认当前时间                    |

## 6. 可视化服务数据库设计

### 可视化数据表 (visualization_data)

| 字段名                | 数据类型    | 描述               | 约束             |
| --------------------- | ----------- | ------------------ | ---------------- |
| visualization_id      | INT         | 可视化数据唯一标识 | 主键，自增       |
| hospital_id           | INT         | 医院唯一标识       | 外键，关联医院表 |
| visualization_type    | VARCHAR(50) | 可视化类型         | 不可为空         |
| visualization_content | TEXT        | 可视化内容         | 不可为空         |
| created_at            | DATETIME    | 创建时间           | 默认当前时间     |
| updated_at            | DATETIME    | 更新时间           | 默认当前时间     |

## 7. 公共服务数据库设计

### 配置表 (configurations)

| 字段名       | 数据类型     | 描述         | 约束           |
| ------------ | ------------ | ------------ | -------------- |
| config_id    | INT          | 配置唯一标识 | 主键，自增     |
| config_key   | VARCHAR(100) | 配置键       | 唯一，不可为空 |
| config_value | TEXT         | 配置值       | 不可为空       |
| created_at   | DATETIME     | 创建时间     | 默认当前时间   |
| updated_at   | DATETIME     | 更新时间     | 默认当前时间   |

## 总结

以上是针对医保系统微服务架构的数据库设计，包括用户认证服务、数据采集服务、费用查询服务、规则引擎服务、深度分析服务、可视化服务和公共服务的数据库表设计。每个微服务都有独立的数据库，以确保数据的隔离性和安全性，满足系统的功能需求。
